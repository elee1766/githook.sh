<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="githook.sh documentation and guides">
    <title>githook.sh - docs</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<h1><a href="/">githook.sh</a> docs</h1>
<p>
<a href="#creating">creating</a> ·
<a href="#skipping">skipping</a> ·
<a href="#testing">testing</a> ·
<a href="#ci">ci/cd</a> ·
<a href="#languages">languages</a> ·
<a href="#init">init.sh</a> ·
<a href="#nvm">nvm</a> ·
<a href="#examples">examples</a> ·
<a href="#debug">debug</a> ·
<a href="#uninstall">uninstall</a> ·
<a href="#how">how it works</a>
</p>

<h2 id="creating">creating a hook</h2>
<p>add an executable script to <code>.githook/</code> named after the git hook you want:</p>
<pre>echo '#!/bin/sh
npm test' > .githook/pre-commit
chmod +x .githook/pre-commit</pre>
<p>the script must be executable (<code>chmod +x</code>) and start with a shebang (<code>#!/bin/sh</code>).</p>
<p>supported hooks: <code>pre-commit</code>, <code>commit-msg</code>, <code>pre-push</code>, <code>prepare-commit-msg</code>, <code>post-commit</code>, <code>post-merge</code>, <code>pre-rebase</code>, <code>post-checkout</code>, <code>post-rewrite</code>, <code>pre-auto-gc</code>, <code>applypatch-msg</code>, <code>pre-applypatch</code>, <code>post-applypatch</code>.</p>

<h2 id="skipping">skipping hooks</h2>
<p>for a single command, use git's built-in <code>--no-verify</code> flag:</p>
<pre>git commit --no-verify -m "wip"
git push --no-verify</pre>
<p>to disable all hooks for multiple commands:</p>
<pre>GITHOOK=0 git commit -m "skip"
GITHOOK=0 git push</pre>
<p>or export it for your session:</p>
<pre>export GITHOOK=0
git commit -m "first"
git commit -m "second"
unset GITHOOK</pre>

<h2 id="ci">ci/cd and docker</h2>
<p>hooks are for local development—disable them in CI/CD and containers with <code>GITHOOK=0</code>:</p>
<pre># github actions
env:
  GITHOOK: 0

# gitlab ci
variables:
  GITHOOK: "0"

# docker
ENV GITHOOK=0</pre>

<h2 id="testing">testing hooks</h2>
<p>run your hook directly without making a commit:</p>
<pre>./.githook/pre-commit</pre>
<p>to test that hooks block commits properly, add <code>exit 1</code>:</p>
<pre>#!/bin/sh
echo "this will block the commit"
exit 1</pre>
<p>a non-zero exit code aborts the git operation. exit 0 (or no exit) allows it to proceed.</p>

<h2 id="languages">using other languages</h2>
<p>hooks can be written in any language. use a shell wrapper:</p>
<pre>#!/bin/sh
node .githook/pre-commit.js</pre>
<p>or use a shebang directly (the file must still be executable):</p>
<pre>#!/usr/bin/env python3
import subprocess
import sys
result = subprocess.run(["pytest", "-x"])
sys.exit(result.returncode)</pre>
<pre>#!/usr/bin/env ruby
system("bundle exec rubocop") || exit(1)</pre>
<p>remember: exit with non-zero to block the git operation.</p>

<h2 id="init">global init script</h2>
<p>create <code>~/.config/githook/init.sh</code> to run setup before any hook in any repo. useful for setting up PATH, node version managers, etc.</p>
<pre>mkdir -p ~/.config/githook
cat > ~/.config/githook/init.sh << 'EOF'
# nvm
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"

# fnm
# eval "$(fnm env)"

# volta
# export VOLTA_HOME="$HOME/.volta"
# export PATH="$VOLTA_HOME/bin:$PATH"
EOF</pre>
<p>this is sourced before every hook runs, so you don't need to repeat setup in each hook script.</p>

<h2 id="nvm">node version managers</h2>
<p>gui clients and ides may not load your shell profile, causing "command not found" errors. either use the <a href="#init">global init script</a>, or source your version manager in each hook:</p>
<p>nvm:</p>
<pre>#!/bin/sh
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"
npm test</pre>
<p>fnm:</p>
<pre>#!/bin/sh
eval "$(fnm env)"
npm test</pre>
<p>volta (usually works without config, but if needed):</p>
<pre>#!/bin/sh
export VOLTA_HOME="$HOME/.volta"
export PATH="$VOLTA_HOME/bin:$PATH"
npm test</pre>

<h2 id="examples">common hooks</h2>
<p><strong>pre-commit</strong> — runs before commit is created. use for linting, formatting, tests:</p>
<pre>#!/bin/sh
npm run lint && npm test</pre>
<p><strong>commit-msg</strong> — validate commit message format. <code>$1</code> is the temp file containing the message:</p>
<pre>#!/bin/sh
if ! grep -qE "^(feat|fix|docs|style|refactor|test|chore)(\(.+\))?: .+" "$1"; then
  echo "error: commit message must follow conventional commits format"
  echo "example: feat(auth): add login endpoint"
  exit 1
fi</pre>
<p><strong>pre-push</strong> — runs before push. use for full test suite or build verification:</p>
<pre>#!/bin/sh
npm run build && npm run test:all</pre>
<p><strong>post-merge</strong> — runs after merge/pull. use to reinstall deps if lockfile changed:</p>
<pre>#!/bin/sh
changed_files=$(git diff-tree -r --name-only ORIG_HEAD HEAD)
if echo "$changed_files" | grep -q "package-lock.json"; then
  echo "package-lock.json changed, running npm install..."
  npm install
fi</pre>

<h2 id="debug">debugging</h2>
<p>enable debug output to see what githook.sh is doing:</p>
<pre>GITHOOK_DEBUG=1 git commit -m "test"</pre>
<p>common issues:</p>
<p>• <strong>"command not found"</strong> — your PATH isn't set. see the <a href="#nvm">nvm section</a> for fixes.</p>
<p>• <strong>hook not running</strong> — check it's executable: <code>ls -la .githook/</code></p>
<p>• <strong>wrong directory</strong> — hooks run from repo root. use <code>cd</code> if needed.</p>

<h2 id="uninstall">uninstalling</h2>
<p>remove the git configuration (keeps your hook scripts):</p>
<pre>./.githook.sh uninstall</pre>
<p>this unsets <code>core.hooksPath</code>. your <code>.githook/</code> scripts remain so you can reinstall later.</p>
<p>to fully remove everything:</p>
<pre>rm -rf .githook .githook.sh</pre>
<p>also remove the prepare script from package.json if you added one.</p>

<h2 id="how">how it works</h2>
<p>githook.sh uses git's native <code>core.hooksPath</code> config:</p>
<pre>git config core.hooksPath .githook/_</pre>
<p>the structure is:</p>
<pre>.githook/
  _/          # internal wrappers (git-ignored, created by install)
    h         # shared hook runner
    pre-commit, commit-msg, ...
  pre-commit  # your hook scripts
  commit-msg
  ...</pre>
<p>when git runs a hook, it calls the wrapper in <code>_/</code>, which sources <code>~/.config/githook/init.sh</code> if it exists, checks <code>GITHOOK=0</code>, and then runs your script from the parent directory.</p>
<p>benefits:</p>
<p>• hooks are version-controlled (committed to repo)</p>
<p>• <code>GITHOOK=0</code> skips all hooks without <code>--no-verify</code></p>
<p>• works with any project type (not just npm)</p>
<p>• zero dependencies—just a shell script</p>
<p>each developer must run <code>./.githook.sh install</code> once after cloning because git config is local to each clone.</p>
</body>
</html>
